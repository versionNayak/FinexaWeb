<div>
	<div id="viewAmountNeededPrintdiv" >	
		<div id="tabContentAmmountNeeded" style="page-break-after: always;" data-special="multi-print-section" id="page13">
			<header style="display:none;">
				<br/>
				<table width="100%" style="background-color:#FFFFFF !important;">
					<tr style="background-color: #FFFFFF !important;">
						<td width="50%" align="left"><div style="color:#696969;"> Advisor logo </div></td>
						<td width="50%" align="right"><img class="headerLogo" width="100px" src="../Common/assets/images/finexa-logo.jpg"></td>
					</tr>
				</table>
				<div class="separatorPDF">&nbsp;&nbsp;</div>
			</header>
			<footer style="margin-top:-70px;display:none;">
				<table width="100%" style="background-color:#FFFFFF !important;">
					<tr style="background-color: #FFFFFF !important;">
						<td width="100%" align="right" style="color:#004080">
							Advisor:<span class="advisorName">Finlabs Administrator</span>
							&nbsp;&nbsp;|&nbsp;&nbsp;Client ID:<span class="clientID">123456789</span>
							
							<div style="" class="separatorPDF">&nbsp;&nbsp;</div>
							<span style="margin-top:-45px;background-color:#004080;color:white;padding:7px;width:5%;">
								<pagenum/>
							</span>
						</td>
					</tr>
					<tr style="background-color: #FFFFFF !important;">
						<td width="50%" align="left" style="color:#004080">
							<span class="footerCaption">Finlabs India&copy; <span class="year">2017</span> All Rights Reserved</span>
						</td>
					</tr>
				</table>
			</footer>
			<br/>	
			
			<div class="pageMainWrapperPDF">				
				<h3 class="reportTypeHeadingPDF">Goal Planning Report</h3>
				<div class="contentWrapperPDF">
					<div class="contentHeadingPDF">Amount Needed</div>
					<div class="mainContentPDF">
						<br/>
						<table width="100%">
							<tr>
								<th>Amount to be Invested</th>
								<th>&nbsp;</th>
								<th>&nbsp;</th>
							</tr>
							<tr>
								<td>&nbsp;</td>
								<td>Recommended</td>
								<td>Options</td>
							</tr>
							<tr>
								<td>Lumpsum Investment Required Today</td>
								<td id="idLumpsumInvestmentTodayPDF">631,349</td>
								<td>
									<span id="textOptionLump">No</span>
								</td>
							</tr>
							<tr>
								<td>SIP Investment Required Today</td>
								<td id="idSipInvestmentTodayPDF">8,343</td>
								<td>
									<span id="textOptionSIP">Yes</span>
								</td>
							</tr>
							<tr>
								<td>Lumpsum Investment today <br/><br/> SIP Investment Required Today</td>
								<td style="text-align:left">
									<p id="textLumpsumInput"></span>
									<p id="textSIPForLumpsum"></span>
								</td>
								<td class="amtrdo">
									<span id="textOptionLumpSIP">No</span>
								</td>
							</tr>
						</table> 
					
						<div style="display:none;">
							<input type="radio" name="ammountNeedOptionsPDF" id="idLumpSIPRadio" class="hidden" />
							<input type="radio" name="ammountNeedOptionsPDF" id="idLumpRadioPDF" class="hidden" />
						 	<input type="radio" name="ammountNeedOptionsPDF" id="idSIPRadio" class="hidden" />
						 	<input type="text" id="idLumpsumInputPDF" class="form-control hidden" /><br /> 
							<input type="text" id="idSIPForLumpsumPDF" class="form-control hidden" readonly/>
						</div>									
					</div>
				</div>				
			</div>		
		</div>
		<div id="graphContentAmmountNeeded" style="page-break-after: always;" data-special="multi-print-section" id="page14">
			<header style="display:none;">
				<br/>
				<table width="100%" style="background-color:#FFFFFF !important;">
					<tr style="background-color: #FFFFFF !important;">
						<td width="50%" align="left"><div style="color:#696969;"> Advisor logo </div></td>
						<td width="50%" align="right"><img class="headerLogo" width="100px" src="../Common/assets/images/finexa-logo.jpg"></td>
					</tr>
				</table>
				<div class="separatorPDF">&nbsp;&nbsp;</div>
			</header>
			<footer style="margin-top:-70px;display:none;">
				<table width="100%" style="background-color:#FFFFFF !important;">
					<tr style="background-color: #FFFFFF !important;">
						<td width="100%" align="right" style="color:#004080">
							Advisor:<span class="advisorName">Finlabs Administrator</span>
							&nbsp;&nbsp;|&nbsp;&nbsp;Client ID:<span class="clientID">123456789</span>
							
							<div style="" class="separatorPDF">&nbsp;&nbsp;</div>
							<span style="margin-top:-45px;background-color:#004080;color:white;padding:7px;width:5%;">
								<pagenum/>
							</span>
						</td>
					</tr>
					<tr style="background-color: #FFFFFF !important;">
						<td width="50%" align="left" style="color:#004080">
							<span class="footerCaption">Finlabs India&copy; <span class="year">2017</span> All Rights Reserved</span>
						</td>
					</tr>
				</table>
			</footer>
			<br/>	
			
			<div class="pageMainWrapperPDF">				
				<h3 class="reportTypeHeadingPDF">Goal Planning Report</h3>
				<div class="contentWrapperPDF">
					<div class="contentHeadingPDF">Goal Corpus Accumulation</div>
					<div class="mainContentPDF">
						<div align="center" id="idAmountneedGraphPDF" style="width:600px;height:500px;" ></div>
						<canvas id="canvasidAmountneedGraphPDF" width="600px" height="500px" style="display:none;width:600px;height:500px;"></canvas>
						<div id="pngidAmountneedGraphPDF" style="display:none;width:600px;height:500px;">
							<img id="imgidAmountneedGraphPDF" src="">
						</div>								
					</div>
				</div>				
			</div>
		</div>
	</div>
	
	<div id="viewAmountNeededJsdiv">		
		<script type="text/javascript">
		//jQuery(document).ready(function ($) {
			
			getDataUri(
					'../Common/assets/images/finexa-logo.jpg',
					function(dataUri) {
						$('.headerLogo').attr("src", dataUri);
					});
			
			getDataUri(
					'../Common/assets/images/finexa-logo.jpg',
					function(dataUri) {
						$('#page13Logo')
								.attr("src", dataUri);
					});
			
			getDataUri(
					'../Common/assets/images/finexa-logo.jpg',
					function(dataUri) {
						$('#page14Logo')
								.attr("src", dataUri);
					});
			
			var AmmounNeededInpData = JSON.parse(localStorage.getItem("AmmounNeededInpData"));		
			
			var lumpsumVal = 0;
			var sipVal = 0;
			var lumpsumSipval;
			var categories = [];
			var worstcase = [];
			var bestcase = [];
			var mostLikely = [];	
			var selectedMode = 2;
			var lumpsumForSIP = 0;
			
			
			if(AmmounNeededInpData == null 
			   || AmmounNeededInpData.sip_Val == null
			   || AmmounNeededInpData.lumpsum_Val == null 
			   || AmmounNeededInpData.selected_option == null){
							
				$.ajax({
					type: 'GET',
					url: REQUEST_URL_GP + '/getGoalLumpsumSIPValue?clientId='+vClientId+
					'&goalId='+goalId+'&glideNonglideMode='+vglideNonglideMode,
					async: false,
					dataType: 'json',
					success: function (data) {
						lumpsumVal = data.lumpsumAmt;
						sipVal = data.sipAmt;
						$("#idLumpsumInvestmentTodayPDF").text(maskAmountValue(lumpsumVal));
						$("#idSipInvestmentTodayPDF").text(maskAmountValue(sipVal));		
					}, 
					error: function (data) {
						alert("error");
					}
				});
				
				selectedMode = 2;
				
				$("#idLumpsumInputPDF").val("");
				$("#idSIPForLumpsumPDF").val("");
				$('#textOptionLumpSIP').text("No");
				$('#textOptionLump').text("No");
				$('#textOptionSIP').text("Yes");
				$('#textSIPForLumpsum').text("");
				$('#textLumpsumInput').text("");
								
				lumpsumForSIP = 0;
				
				callLumpsumSipAjax();
				
			}else{
				
				lumpsumVal = maskAmountValue(AmmounNeededInpData.lumpsum_Val);
				sipVal = maskAmountValue(AmmounNeededInpData.sip_Val);
				
				console.log(AmmounNeededInpData);
				
				$("#idLumpsumInvestmentTodayPDF").text(lumpsumVal);
				$("#idSipInvestmentTodayPDF").text(sipVal);	
				
				if (AmmounNeededInpData.selected_option == 'idLumpRadio') {
					$("#idLumpRadioPDF").prop("checked",true);					
					selectedMode = 1;					
					$("#idLumpsumInputPDF").val("");
					$("#idSIPForLumpsumPDF").val("");
					$('#textOptionLumpSIP').text("No");
					$('#textOptionLump').text("Yes");
					$('#textOptionSIP').text("No");
					$('#textSIPForLumpsum').text("");
					$('#textLumpsumInput').text("");					
				} else if (AmmounNeededInpData.selected_option == 'idSIPRadio') {
					$("#idSIPRadioPDF").prop("checked",true);
					selectedMode = 2;
					$("#idLumpsumInputPDF").val("");
					$("#idSIPForLumpsumPDF").val("");
					$('#textOptionLumpSIP').text("No");
					$('#textOptionLump').text("No");
					$('#textOptionSIP').text("Yes");
					$('#textSIPForLumpsum').text("");
					$('#textLumpsumInput').text("");					
				} else if (AmmounNeededInpData.selected_option == 'idLumpSIPRadio') {
					$("#idLumpSIPRadioPDF").prop("checked",true);					
					selectedMode = 3;					
					$("#idLumpsumInputPDF").val(maskAmountValue(AmmounNeededInpData.lumpsum_investment_today));
					$("#idSIPForLumpsumPDF").val(maskAmountValue(AmmounNeededInpData.sip_investment_required_today));
					$('#textOptionLumpSIP').text("Yes");
					$('#textOptionLump').text("No");
					$('#textOptionSIP').text("No");
					$('#textSIPForLumpsum').text(maskAmountValue(AmmounNeededInpData.sip_investment_required_today));
					$('#textLumpsumInput').text(maskAmountValue(AmmounNeededInpData.lumpsum_investment_today));					
				}
				
				callLumpsumSipAjax();
			}
			
			
			function callLumpsumSipAjax () {
				categories = [];
				worstcase = [];
				bestcase = [];
				mostLikely = [];
				$.ajax({
					type: 'GET',
					url: REQUEST_URL_GP + '/getAmountNeededDetailsForParticularMode?clientId='+vClientId+
					'&goalId='+goalId+'&mode='+selectedMode+'&lumpsumValue='+lumpsumForSIP+
					'&glideNonglideMode='+vglideNonglideMode,
					async: false,
					dataType: 'json',
					success: function (data) {
						if (selectedMode == 3) {
							$("#idSIPForLumpsumPDF").val(""+maskAmountValue(parseInt(data.sipAmtCombo)));
						}
						$.each(data.fundedCorpusList,function(index, value) {
							categories.push(value.timeMonthYear);
							worstcase.push(parseInt(value.corpusWC));
							bestcase.push(parseInt(value.corpusBC));
							mostLikely.push(parseInt(value.corpusML))
						});
						loadChartPDF();			
					}, 
					error: function (data) {  }
				});
			}
			
			var chartAmountneedGraphPDF;
					
			function loadChartPDF() {
				
				chartAmountneedGraphPDF = Highcharts.chart('idAmountneedGraphPDF', {
		
					title: {
						text: '<b>Goal Corpus Accumulation</b>'
					},
		
					xAxis: {
						categories: categories
					},
		
					tooltip: {
						headerFormat: '<b>{series.name}</b><br />',
		
					},
		
					series: [{
						name:"Funded Corpus(most Likely)",
						color:'#3a3a4f',
						data:mostLikely
		
					},{
						name:"Funded Corpus(worst Case)",
						color:'#f7a35c',
						data:worstcase
		
					},{
						name:"Funded Corpus(best Case)",
						color:'#95ceff',
						data:bestcase
		
					}],
					exporting: {
			         	enabled: false
					}
				});
				
				//replaceChartToImage();
				setTimeout(
			    	function() {
			      		replaceChartToImage();
			    },1000); 
			}
			
			function replaceChartToImage(){
								
				var svg = chartAmountneedGraphPDF.getSVG()
	            .replace(/</g, '\n&lt;') // make it slightly more readable
	            .replace(/>/g, '&gt;');
				
				var svgString = new XMLSerializer().serializeToString(document.querySelector("#idAmountneedGraphPDF svg"));
				var canvas = document.getElementById("canvasidAmountneedGraphPDF");
				$('#canvasidAmountneedGraphPDF').height($('#idAmountneedGraphPDF').height()).width($('#idAmountneedGraphPDF').width());
				var ctx = canvas.getContext("2d");
				var DOMURL = self.URL || self.webkitURL || self;
				var img = new Image();
				var svg = new Blob([svgString], {type: "image/svg+xml;charset=utf-8"});
				var url = DOMURL.createObjectURL(svg);
				img.onload = function() {
				    ctx.drawImage(img, 0, 0);
				    var png = canvas.toDataURL("image/png");
				    //document.querySelector('#pngidAmountneedGraphPDF').innerHTML = '<img src="'+png+'"/>';				    
				    $('#imgidAmountneedGraphPDF').attr("src",png);				    
				    DOMURL.revokeObjectURL(png);
				};
				img.src = url;
				$('#canvasidAmountneedGraphPDF').addClass("noprint").hide().remove();
				$('#idAmountneedGraphPDF').addClass("noprint").hide();
				$('#pngidAmountneedGraphPDF').css("display","block");
				//.height($('#idAmountneedGraphPDF').height()).width($('#idAmountneedGraphPDF').width());
			}
		
		//});
		</script>
	</div>
</div>